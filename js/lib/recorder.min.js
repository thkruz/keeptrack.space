function CanvasRecorder(e, o) {
  ;(this.start = function () {
    let e = [
      'video/webm',
      'video/webm,codecs=vp9',
      'video/vp8',
      'video/webm;codecs=vp8',
      'video/webm;codecs=daala',
      'video/webm;codecs=h264',
      'video/mpeg',
    ]
    for (let o in e)
      if (MediaRecorder.isTypeSupported(e[o])) {
        d = e[o]
        break
      }
    null == d && console.log('No supported type found for MediaRecorder')
    let c = { mimeType: d, videoBitsPerSecond: o || 25e5 }
    t = []
    try {
      n = new MediaRecorder(r, c)
    } catch (e) {
      return (
        alert('MediaRecorder is not supported by this browser.'),
        void console.error('Exception while creating MediaRecorder:', e)
      )
    }
    console.log('Created MediaRecorder', n, 'with options', c),
      (n.onstop = a),
      (n.ondataavailable = i),
      n.start(100),
      console.log('MediaRecorder started', n)
  }),
    (this.stop = function () {
      n.stop(), console.log('Recorded Blobs: ', t), (c.controls = !0)
    }),
    (this.save = function (e) {
      const o = e || 'recording.webm',
        n = new Blob(t, { type: d }),
        r = window.URL.createObjectURL(n),
        c = document.createElement('a')
      ;(c.style.display = 'none'),
        (c.href = r),
        (c.download = o),
        document.body.appendChild(c),
        c.click(),
        setTimeout(() => {
          document.body.removeChild(c), window.URL.revokeObjectURL(r)
        }, 100)
    })
  var t = [],
    d = null,
    n = null,
    r = e.captureStream()
  if (void 0 == typeof r || !r) return
  const c = document.createElement('video')
  function i(e) {
    e.data && e.data.size > 0 && t.push(e.data)
  }
  function a(e) {
    console.log('Recorder stopped: ', e)
    const o = new Blob(t, { type: d })
    c.src = window.URL.createObjectURL(o)
  }
  c.style.display = 'none'
}

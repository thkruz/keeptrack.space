var gl,pitchRotate,yawRotate,pickFb,pickTex,pickColorBuf,fpsEl,fpsAz,drawLoopCallback,debugTimeArray=[],timeManager=window.timeManager,satCruncher=window.satCruncher,camYaw=0,camPitch=.5,camYawTarget=0,camPitchTarget=0,camSnapMode=!1,camZoomSnappedOnSat=!1,camAngleSnappedOnSat=!1,zoomLevel=.5,zoomTarget=.5,isZoomIn=!1,camPitchSpeed=0,camYawSpeed=0,camRotateSpeed=0,isEditSatMenuOpen=!1,isDOPMenuOpen=!1,isLookanglesMenuOpen=!1,isLookanglesMultiSiteMenuOpen=!1,isNewLaunchMenuOpen=!1,isBreakupMenuOpen=!1,isMissileMenuOpen=!1,isPlanetariumView=!1,isAstronomyView=!1,isSatView=!1,isVideoRecording=!1,isCustomSensorMenuOpen=!1,pMatrix=mat4.create(),camMatrix=mat4.create(),camMatrixEmpty=mat4.create(),selectedSat=-1,lastSelectedSat=-1,drawLineList=[],updateHoverDelay=0,updateHoverDelayLimit=1,cameraType={current:0,DEFAULT:0,OFFSET:1,FPS:2,PLANETARIUM:3,SATELLITE:4,ASTRONOMY:5},mouseX=0,mouseY=0,mouseTimeout=null,mouseSat=-1,isMouseMoving=!1,dragPoint=[0,0,0],screenDragPoint=[0,0],dragStartPitch=0,dragStartYaw=0,isDragging=!1,dragHasMoved=!1,isPinching=!1,deltaPinchDistance=0,startPinchDistance=0,fpsPitch=0,fpsPitchRate=0,fpsRotate=0,fpsRotateRate=0,fpsYaw=0,fpsYawRate=0,fpsXPos=0,fpsYPos=25e3,fpsZPos=0,fpsForwardSpeed=0,fpsSideSpeed=0,fpsVertSpeed=0,isFPSForwardSpeedLock=!1,isFPSSideSpeedLock=!1,isFPSVertSpeedLock=!1,fpsRun=1,fpsLastTime=1,satScreenPositionArray={},isShowNextPass=!1,rotateTheEarth=!0;function webGlInit(){db.log("webGlInit");var e=$("#canvas")[0];e.width=window.innerWidth,e.height=window.innerHeight;var t=e.getContext("webgl",{alpha:!1,desynchronized:!0})||e.getContext("experimental-webgl",{alpha:!1,desynchronized:!0});t||browserUnsupported(),t.viewport(0,0,e.width,e.height),t.enable(t.DEPTH_TEST);var a=t.createShader(t.FRAGMENT_SHADER),s=shaderLoader.getShaderCode("pick-fragment.glsl");t.shaderSource(a,s),t.compileShader(a);var r=t.createShader(t.VERTEX_SHADER),i=shaderLoader.getShaderCode("pick-vertex.glsl");t.shaderSource(r,i),t.compileShader(r);var n=t.createProgram();t.attachShader(n,r),t.attachShader(n,a),t.linkProgram(n),n.aPos=t.getAttribLocation(n,"aPos"),n.aColor=t.getAttribLocation(n,"aColor"),n.aPickable=t.getAttribLocation(n,"aPickable"),n.uCamMatrix=t.getUniformLocation(n,"uCamMatrix"),n.uMvMatrix=t.getUniformLocation(n,"uMvMatrix"),n.uPMatrix=t.getUniformLocation(n,"uPMatrix"),t.pickShaderProgram=n,pickFb=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,pickFb),pickTex=t.createTexture(),t.bindTexture(t.TEXTURE_2D,pickTex),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.drawingBufferWidth,t.drawingBufferHeight,0,t.RGBA,t.UNSIGNED_BYTE,null);var o=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,o),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,t.drawingBufferWidth,t.drawingBufferHeight),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,pickTex,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,o),t.pickFb=pickFb,pickColorBuf=new Uint8Array(4),pMatrix=mat4.create(),mat4.perspective(pMatrix,settingsManager.fieldOfView,t.drawingBufferWidth/t.drawingBufferHeight,20,6e5);mat4.mul(pMatrix,pMatrix,[1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),window.gl=t}function _getCamDist(){return db.log("_getCamDist",!0),Math.pow(zoomLevel,ZOOM_EXP)*(DIST_MAX-DIST_MIN)+DIST_MIN}function _unProject(e,t){return glScreenX=e/gl.drawingBufferWidth*2-1,glScreenY=1-t/gl.drawingBufferHeight*2,screenVec=[glScreenX,glScreenY,-.01,1],comboPMat=mat4.create(),mat4.mul(comboPMat,pMatrix,camMatrix),invMat=mat4.create(),mat4.invert(invMat,comboPMat),worldVec=vec4.create(),vec4.transformMat4(worldVec,screenVec,invMat),[worldVec[0]/worldVec[3],worldVec[1]/worldVec[3],worldVec[2]/worldVec[3]]}function _normalizeAngle(e){return(e%=TAU)>Math.PI&&(e-=TAU),e<-Math.PI&&(e+=TAU),e}function getSatIdFromCoord(e,t){return gl.bindFramebuffer(gl.FRAMEBUFFER,gl.pickFb),gl.readPixels(e,gl.drawingBufferHeight-t,1,1,gl.RGBA,gl.UNSIGNED_BYTE,pickColorBuf),(pickColorBuf[2]<<16|pickColorBuf[1]<<8|pickColorBuf[0])-1}function getEarthScreenPoint(e,t){return rayOrigin=getCamPos(),ptThru=_unProject(e,t),rayDir=vec3.create(),vec3.subtract(rayDir,ptThru,rayOrigin),vec3.normalize(rayDir,rayDir),toCenterVec=vec3.create(),vec3.scale(toCenterVec,rayOrigin,-1),dParallel=vec3.dot(rayDir,toCenterVec),longDir=vec3.create(),vec3.scale(longDir,rayDir,dParallel),vec3.add(ptThru,rayOrigin,longDir),dPerp=vec3.len(ptThru),dSubSurf=Math.sqrt(RADIUS_OF_EARTH*RADIUS_OF_EARTH-dPerp*dPerp),dSurf=dParallel-dSubSurf,ptSurf=vec3.create(),vec3.scale(ptSurf,rayDir,dSurf),vec3.add(ptSurf,ptSurf,rayOrigin),ptSurf}function getCamPos(){return gCPr=_getCamDist(),gCPz=gCPr*Math.sin(camPitch),gCPrYaw=gCPr*Math.cos(camPitch),gCPx=gCPrYaw*Math.sin(camYaw),gCPy=gCPrYaw*-Math.cos(camYaw),[gCPx,gCPy,gCPz]}function longToYaw(e){var t=$("#datetime-text").text().substr(0,19),a=new Date;t=t.split(" "),t=new Date(t[0]+"T"+t[1]+"Z"),a.setUTCHours(t.getUTCHours()+2*t.getUTCMonth()-10),a.setUTCMinutes(t.getUTCMinutes()),a.setUTCSeconds(t.getUTCSeconds()),t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCSeconds(0);var s=(a-t)/60/60/1e3;return s>24&&(s-=24),_normalizeAngle((e+(s*=15))*DEG2RAD)}function latToPitch(e){var t=e*DEG2RAD;return t>TAU/4&&(t=TAU/4),t<-TAU/4&&(t=-TAU/4),t}function camSnap(e,t){camPitchTarget=e,camYawTarget=_normalizeAngle(t),camSnapMode=!0}function changeZoom(e){zoomTarget="geo"!==e?"leo"!==e?e:.45:.82}function updateUrl(){db.log("updateUrl",!0);var e=window.location.href.split("?")[0],t=[];-1!==selectedSat&&"none"!==satSet.getSatExtraOnly(selectedSat).intlDes&&t.push("intldes="+satSet.getSatExtraOnly(selectedSat).intlDes);var a=searchBox.getCurrentSearch();null!=a&&t.push("search="+a),(timeManager.propRate<.99||timeManager.propRate>1.01)&&t.push("rate="+timeManager.propRate),(timeManager.propOffset<-1e3||timeManager.propOffset>1e3)&&t.push("hrs="+(timeManager.propOffset/1e3/3600).toString()),t.length>0&&(e+="?"+t.join("&")),window.history.replaceState(null,"Keeptrack",e)}!function(){var e,t,a,s,r,i,n,o,c,d,l,m,p,S,g,u,M,f,h,w=75e-6,L=!1,T=!0;$(document).ready(function(){void 0===settingsManager.tleSource&&(settingsManager.tleSource="tle/TLE.json"),webGlInit(),earth.init(),ColorScheme.init(),satSet.init(function(e){$("#loader-text").text("Coloring Inside the Lines..."),orbitDisplay.init(),groups.init(),searchBox.init(e)}),x()});var v=0;function x(){if(requestAnimationFrame(x),t=Date.now(),a=t-(e||t),void 0!==v){if(++v>100)return void(v=null);v>50&&a>500&&settingsManager.isSlowCPUModeEnabled}if(a>20?updateHoverDelayLimit=10:a>50?updateHoverDelayLimit=15:updateHoverDelayLimit>1&&--updateHoverDelayLimit,e=t,timeManager.now=t,isDragging&&!settingsManager.isMobileModeEnabled||isDragging&&settingsManager.isMobileModeEnabled&&(0!==mouseX||0!==mouseY)?(n=getEarthScreenPoint(mouseX,mouseY),isNaN(n[0])||isNaN(n[1])||isNaN(n[2])||isNaN(dragPoint[0])||isNaN(dragPoint[1])||isNaN(dragPoint[2])||cameraType.current===cameraType.FPS||cameraType.current===cameraType.SATELLITE||cameraType.current===cameraType.ASTRONOMY||settingsManager.isMobileModeEnabled?(o=screenDragPoint[0]-mouseX,c=screenDragPoint[1]-mouseY,d=dragStartYaw+o*settingsManager.cameraMovementSpeed,l=dragStartPitch+c*-settingsManager.cameraMovementSpeed,camPitchSpeed=_normalizeAngle(camPitch-l)*-settingsManager.cameraMovementSpeed,camYawSpeed=_normalizeAngle(camYaw-d)*-settingsManager.cameraMovementSpeed):(m=Math.sqrt(dragPoint[0]*dragPoint[0]+dragPoint[1]*dragPoint[1]),p=Math.sqrt(n[0]*n[0]+n[1]*n[1]),S=Math.atan2(dragPoint[1],dragPoint[0]),g=Math.atan2(n[1],n[0]),u=Math.atan2(dragPoint[2],m),M=Math.atan2(n[2],p),f=u-M,h=_normalizeAngle(S-g),camPitchSpeed=f*settingsManager.cameraMovementSpeed,camYawSpeed=h*settingsManager.cameraMovementSpeed),camSnapMode=!1):settingsManager.isMobileModeEnabled?settingsManager.isMobileModeEnabled&&(camPitchSpeed-=camPitchSpeed*a*settingsManager.cameraMovementSpeed*5,camYawSpeed-=camYawSpeed*a*settingsManager.cameraMovementSpeed*5):(camPitchSpeed-=camPitchSpeed*a*settingsManager.cameraMovementSpeed,camYawSpeed-=camYawSpeed*a*settingsManager.cameraMovementSpeed),camRotateSpeed-=camRotateSpeed*a*settingsManager.cameraMovementSpeed,cameraType.current===cameraType.FPS||cameraType.current===cameraType.SATELLITE||cameraType.current===cameraType.ASTRONOMY?(fpsYaw-=20*camYawSpeed*a,fpsRotate-=20*camRotateSpeed*a,(fpsPitch-=20*camPitchSpeed*a)>90&&(fpsPitch=90),fpsPitch<-90&&(fpsPitch=-90),cameraType.current===cameraType.ASTRONOMY?(fpsRotate>90&&(fpsRotate=90),fpsRotate<-90&&(fpsRotate=-90)):(fpsRotate>360&&(fpsRotate-=360),fpsRotate<0&&(fpsRotate+=360)),fpsYaw>360&&(fpsYaw-=360),fpsYaw<0&&(fpsYaw+=360)):(camPitch+=camPitchSpeed*a,camYaw+=camYawSpeed*a,fpsRotate+=camRotateSpeed*a),rotateTheEarth&&(camYaw-=w*a),camSnapMode){camPitch+=.003*(camPitchTarget-camPitch)*a;let e=_normalizeAngle(camYawTarget-camYaw);camYaw+=.003*e*a,zoomLevel+=(zoomTarget-zoomLevel)*a*.0025}else isZoomIn?zoomLevel-=zoomLevel*a/100*Math.abs(zoomTarget-zoomLevel):zoomLevel+=zoomLevel*a/100*Math.abs(zoomTarget-zoomLevel),(zoomLevel>=zoomTarget&&!isZoomIn||zoomLevel<=zoomTarget&&isZoomIn)&&(zoomLevel=zoomTarget);if(camPitch>TAU/4&&(camPitch=TAU/4),camPitch<-TAU/4&&(camPitch=-TAU/4),camYaw=_normalizeAngle(camYaw),-1!==selectedSat){let e=satSet.getSat(selectedSat);e.static||function(e){if(camAngleSnappedOnSat){var t=e.position,a=Math.sqrt(t.x*t.x+t.y*t.y),s=Math.atan2(t.y,t.x)+TAU/4,r=Math.atan2(t.z,a);r||(console.warn("Pitch Calculation Error"),r=0,camZoomSnappedOnSat=!1,camAngleSnappedOnSat=!1),s||(console.warn("Yaw Calculation Error"),s=0,camZoomSnappedOnSat=!1,camAngleSnappedOnSat=!1),cameraType.current===cameraType.PLANETARIUM||camSnap(r,s)}if(camZoomSnappedOnSat){var i,n;e.missile||e.static||!e.active||(e.getTEARR(),i=uiManager.currentTEARR.alt),e.missile&&(i=e.maxAlt+1e3,orbitDisplay.setSelectOrbit(e.satId)),i?n=i+RADIUS_OF_EARTH+settingsManager.camDistBuffer:(n=RADIUS_OF_EARTH+settingsManager.camDistBuffer,console.warn("Zoom Calculation Error: "+i+" -- "+n),camZoomSnappedOnSat=!1,camAngleSnappedOnSat=!1),Math.pow((n-DIST_MIN)/(DIST_MAX-DIST_MIN),1/ZOOM_EXP)<zoomTarget&&(zoomTarget=Math.pow((n-DIST_MIN)/(DIST_MAX-DIST_MIN),1/ZOOM_EXP))}cameraType.current===cameraType.PLANETARIUM&&(zoomTarget=.01)}(e),e.static&&(cameraType.current,cameraType.PLANETARIUM)}!function(){gl.bindFramebuffer(gl.FRAMEBUFFER,gl.pickFb),gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),gl.bindFramebuffer(gl.FRAMEBUFFER,null),(cameraType.current===cameraType.FPS||cameraType.current===cameraType.SATELLITE||cameraType.current===cameraType.ASTRONOMY)&&function(){r=Date.now(),0!==fpsLastTime&&(i=r-fpsLastTime,isFPSForwardSpeedLock&&fpsForwardSpeed<0?fpsForwardSpeed=Math.max(fpsForwardSpeed+Math.min(-1.02*fpsForwardSpeed*i,-.2),-settingsManager.fpsForwardSpeed):isFPSForwardSpeedLock&&fpsForwardSpeed>0&&(fpsForwardSpeed=Math.min(fpsForwardSpeed+Math.max(1.02*fpsForwardSpeed*i,.2),settingsManager.fpsForwardSpeed)),isFPSSideSpeedLock&&fpsSideSpeed<0?fpsSideSpeed=Math.max(fpsSideSpeed+Math.min(-1.02*fpsSideSpeed*i,-.2),-settingsManager.fpsSideSpeed):isFPSSideSpeedLock&&fpsSideSpeed<0&&(fpsSideSpeed=Math.min(fpsSideSpeed+Math.max(1.02*fpsSideSpeed*i,.2),settingsManager.fpsSideSpeed)),isFPSVertSpeedLock&&fpsVertSpeed<0?fpsVertSpeed=Math.max(fpsVertSpeed+Math.min(-1.02*fpsVertSpeed*i,-.2),-settingsManager.fpsVertSpeed):isFPSVertSpeedLock&&fpsVertSpeed<0&&(fpsVertSpeed=Math.min(fpsVertSpeed+Math.max(1.02*fpsVertSpeed*i,.2),settingsManager.fpsVertSpeed)),cameraType.FPS&&(0!==fpsForwardSpeed&&(fpsXPos-=Math.sin(fpsYaw*DEG2RAD)*fpsForwardSpeed*fpsRun*i,fpsYPos-=Math.cos(fpsYaw*DEG2RAD)*fpsForwardSpeed*fpsRun*i,fpsZPos+=Math.sin(fpsPitch*DEG2RAD)*fpsForwardSpeed*fpsRun*i),0!==fpsVertSpeed&&(fpsZPos-=fpsVertSpeed*fpsRun*i),0!==fpsSideSpeed&&(fpsXPos-=Math.cos(-fpsYaw*DEG2RAD)*fpsSideSpeed*fpsRun*i,fpsYPos-=Math.sin(-fpsYaw*DEG2RAD)*fpsSideSpeed*fpsRun*i)),isFPSForwardSpeedLock||(fpsForwardSpeed*=Math.min(.98*i,.98)),isFPSSideSpeedLock||(fpsSideSpeed*=Math.min(.98*i,.98)),isFPSVertSpeedLock||(fpsVertSpeed*=Math.min(.98*i,.98)),fpsForwardSpeed<.01&&fpsForwardSpeed>-.01&&(fpsForwardSpeed=0),fpsSideSpeed<.01&&fpsSideSpeed>-.01&&(fpsSideSpeed=0),fpsVertSpeed<.01&&fpsVertSpeed>-.01&&(fpsVertSpeed=0),fpsPitch+=fpsPitchRate*i,fpsRotate+=fpsRotateRate*i,fpsYaw+=fpsYawRate*i);fpsLastTime=r}();camMatrix=function(){camMatrix=camMatrixEmpty,mat4.identity(camMatrix),(isNaN(camPitch)||isNaN(camYaw)||isNaN(camPitchTarget)||isNaN(camYawTarget)||isNaN(zoomLevel)||isNaN(zoomTarget))&&(camPitch=.5,camYaw=.5,zoomLevel=.5,camPitchTarget=0,camYawTarget=0,zoomTarget=.5,console.error("Camera Math Error - Camera Reset"));switch(cameraType.current){case cameraType.DEFAULT:mat4.translate(camMatrix,camMatrix,[0,_getCamDist(),0]),mat4.rotateX(camMatrix,camMatrix,camPitch),mat4.rotateZ(camMatrix,camMatrix,-camYaw);break;case cameraType.OFFSET:mat4.translate(camMatrix,camMatrix,[15e3,_getCamDist(),-6e3]),mat4.rotateX(camMatrix,camMatrix,camPitch),mat4.rotateZ(camMatrix,camMatrix,-camYaw);break;case cameraType.FPS:mat4.rotate(camMatrix,camMatrix,-fpsPitch*DEG2RAD,[1,0,0]),mat4.rotate(camMatrix,camMatrix,fpsYaw*DEG2RAD,[0,0,1]),mat4.translate(camMatrix,camMatrix,[fpsXPos,fpsYPos,-fpsZPos]);break;case cameraType.PLANETARIUM:{let e=b({});pitchRotate=-1*sensorManager.currentSensor.lat*DEG2RAD,yawRotate=(90-sensorManager.currentSensor.long)*DEG2RAD-e.gmst,mat4.rotate(camMatrix,camMatrix,pitchRotate,[1,0,0]),mat4.rotate(camMatrix,camMatrix,yawRotate,[0,0,1]),mat4.translate(camMatrix,camMatrix,[-e.x,-e.y,-e.z]),D();break}case cameraType.SATELLITE:{-1!==selectedSat&&(lastSelectedSat=selectedSat);let e=satSet.getSat(lastSelectedSat);mat4.rotate(camMatrix,camMatrix,-fpsPitch*DEG2RAD,[1,0,0]),mat4.rotate(camMatrix,camMatrix,fpsYaw*DEG2RAD,[0,0,1]),mat4.rotate(camMatrix,camMatrix,fpsRotate*DEG2RAD,[0,1,0]),orbitDisplay.updateOrbitBuffer(lastSelectedSat);let t=e.position;mat4.translate(camMatrix,camMatrix,[-t.x,-t.y,-t.z]);break}case cameraType.ASTRONOMY:{let e=b({});pitchRotate=-1*sensorManager.currentSensor.lat*DEG2RAD,yawRotate=(90-sensorManager.currentSensor.long)*DEG2RAD-e.gmst;let t=null;if(void 0===sensorManager.currentSensor.name){if(null==(t=satSet.getIdFromSensorName(sensorManager.currentSensor.name)))return}else t=satSet.getSat(satSet.getIdFromSensorName(sensorManager.currentSensor.name));mat4.rotate(camMatrix,camMatrix,pitchRotate+-fpsPitch*DEG2RAD,[1,0,0]),mat4.rotate(camMatrix,camMatrix,yawRotate+fpsYaw*DEG2RAD,[0,0,1]),mat4.rotate(camMatrix,camMatrix,fpsRotate*DEG2RAD,[0,1,0]);let a=t.position;fpsXPos=a.x,fpsYPos=a.y,fpsZPos=a.z,mat4.translate(camMatrix,camMatrix,[1.01*-a.x,1.01*-a.y,1.01*-a.z]),D();break}}return camMatrix}(),gl.useProgram(gl.pickShaderProgram),gl.uniformMatrix4fv(gl.pickShaderProgram.uPMatrix,!1,pMatrix),gl.uniformMatrix4fv(gl.pickShaderProgram.camMatrix,!1,camMatrix),gl.clearColor(0,0,0,1),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT),earth.draw(pMatrix,camMatrix),satSet.draw(pMatrix,camMatrix,t),orbitDisplay.draw(pMatrix,camMatrix)}(),drawLines(),function(){if(searchBox.isHovering())s=searchBox.getHoverSat(),satSet.getScreenCoords(s,pMatrix,camMatrix),e=satScreenPositionArray.x,t=satScreenPositionArray.y,gl.bindFramebuffer(gl.FRAMEBUFFER,gl.pickFb),gl.readPixels(e,gl.drawingBufferHeight-t,1,1,gl.RGBA,gl.UNSIGNED_BYTE,pickColorBuf),0!==pickColorBuf[0]||0!==pickColorBuf[1]||0!==pickColorBuf[2]?A(s,satScreenPositionArray.x,satScreenPositionArray.y):A(-1,0,0);else{if(!isMouseMoving||isDragging||settingsManager.isMobileModeEnabled)return;++updateHoverDelay>=updateHoverDelayLimit&&(updateHoverDelay=0,mouseSat=getSatIdFromCoord(mouseX,mouseY)),-1!==mouseSat?orbitDisplay.setHoverOrbit(mouseSat):orbitDisplay.clearHoverOrbit(),satSet.setHover(mouseSat),A(mouseSat,mouseX,mouseY)}var e,t}(),function(e){if(void 0===e)return;e()}(drawLoopCallback),settingsManager.isDemoModeOn&&function(){if(!sensorManager.checkSensorSelected())return;if(t-O<settingsManager.demoModeInterval)return;O=t,F===satSet.getSatData().length&&(F=0);for(var e=F;e<satSet.getSatData().length;e++){var a=satSet.getSat(e);if(!a.static&&!(a.missile||1===a.OT&&!1===ColorScheme.objectTypeFlags.payload||2===a.OT&&!1===ColorScheme.objectTypeFlags.rocketBody||3===a.OT&&!1===ColorScheme.objectTypeFlags.debris||a.inview&&!1===ColorScheme.objectTypeFlags.inFOV||(satSet.getScreenCoords(e,pMatrix,camMatrix),satScreenPositionArray.error||void 0===satScreenPositionArray.x||void 0===satScreenPositionArray.y||satScreenPositionArray.x>window.innerWidth||satScreenPositionArray.y>window.innerHeight)))return A(e,satScreenPositionArray.x,satScreenPositionArray.y),orbitDisplay.setSelectOrbit(e),void(F=e+1)}}(),settingsManager.isSatLabelModeOn&&cameraType.current===cameraType.PLANETARIUM||(C&&$("#sat-minibox").html(""),C=!1)}function b(e){var t,a,s,r,i,n,o=timeManager.propTime(),c=(t=o.getUTCFullYear(),a=o.getUTCMonth()+1,s=o.getUTCDate(),r=o.getUTCHours(),i=o.getUTCMinutes(),n=o.getUTCSeconds(),367*t-Math.floor(7*(t+Math.floor((a+9)/12))*.25)+Math.floor(275*a/9)+s+1721013.5+((n/60+i)/60+r)/24);c+=1.15741e-8*o.getUTCMilliseconds();var d=satellite.gstime(c),l=Math.cos(sensorManager.currentSensor.lat*DEG2RAD),m=Math.sin(sensorManager.currentSensor.lat*DEG2RAD),p=Math.cos(sensorManager.currentSensor.long*DEG2RAD+d),S=Math.sin(sensorManager.currentSensor.long*DEG2RAD+d);return e.x=(RADIUS_OF_EARTH+PLANETARIUM_DIST)*l*p,e.y=(RADIUS_OF_EARTH+PLANETARIUM_DIST)*l*S,e.z=(RADIUS_OF_EARTH+PLANETARIUM_DIST)*m,e.gmst=d,e}var P,y,R=0,C=!1,E=[];function D(){if(!settingsManager.isSatLabelModeOn||cameraType.current!==cameraType.PLANETARIUM)return C&&$("#sat-minibox").html(""),void(C=!1);if(sensorManager.checkSensorSelected()&&!(t-R<settingsManager.satLabelInterval)){var e;orbitDisplay.clearInViewOrbit(),P=0,L=!0,(E=document.getElementById("sat-minibox")).innerHTML="";for(var a=0;a<satSet.orbitalSats&&P<settingsManager.maxLabels;a++)(e=satSet.getSatPosOnly(a)).static||e.missile||1===e.OT&&!1===ColorScheme.objectTypeFlags.payload||2===e.OT&&!1===ColorScheme.objectTypeFlags.rocketBody||3===e.OT&&!1===ColorScheme.objectTypeFlags.debris||e.inview&&!1===ColorScheme.objectTypeFlags.inFOV||(satSet.getScreenCoords(a,pMatrix,camMatrix,e.position),satScreenPositionArray.error||void 0!==satScreenPositionArray.x&&void 0!==satScreenPositionArray.y&&(satScreenPositionArray.x>window.innerWidth||satScreenPositionArray.y>window.innerHeight||(orbitDisplay.addInViewOrbit(a),(y=document.createElement("div")).id="sat-minibox-"+a,y.textContent=e.SCC_NUM,y.setAttribute("style","display: block; position: absolute; left: "+satScreenPositionArray.x+"10px; top: "+satScreenPositionArray.y+"px;"),E.appendChild(y),P++)));C=!0,R=t}}function A(e,t,a){if(cameraType.current===cameraType.PLANETARIUM&&!settingsManager.isDemoModeOn)return satHoverBoxDOM.css({display:"none"}),void(-1===e?canvasDOM.css({cursor:"default"}):canvasDOM.css({cursor:"pointer"}));if(-1===e){if(!L||settingsManager.isDisableSatHoverBox)return;!0!==starManager.isConstellationVisible||starManager.isAllConstellationVisible||starManager.clearConstellations(),satHoverBoxDOM.css({display:"none"}),canvasDOM.css({cursor:"default"}),L=!1}else if(!isDragging&&!settingsManager.isDisableSatHoverBox){var s=satSet.getSatExtraOnly(e),r=satSet.getSatExtraOnly(selectedSat);if(L=!0,s.static)if("Launch Facility"===s.type){var i=objectManager.extractLaunchSite(s.name);satHoverBoxNode1.textContent=i.site+", "+i.sitec,satHoverBoxNode2.innerHTML=s.type+satellite.distance(s,r)+"",satHoverBoxNode3.textContent=""}else"Control Facility"===s.type?(satHoverBoxNode1.textContent=s.name,satHoverBoxNode2.innerHTML=s.typeExt+satellite.distance(s,r)+"",satHoverBoxNode3.textContent=""):"Star"===s.type?(null!==starManager.findStarsConstellation(s.name)?satHoverBoxNode1.innerHTML=s.name+"</br>"+starManager.findStarsConstellation(s.name):satHoverBoxNode1.textContent=s.name,satHoverBoxNode2.innerHTML=s.type,satHoverBoxNode3.innerHTML="RA: "+s.ra.toFixed(3)+" deg </br> DEC: "+s.dec.toFixed(3)+" deg",starManager.drawConstellations(starManager.findStarsConstellation(s.name))):(satHoverBoxNode1.textContent=s.name,satHoverBoxNode2.innerHTML=s.type+satellite.distance(s,r)+"",satHoverBoxNode3.textContent="");else s.missile?(satHoverBoxNode1.innerHTML=s.ON+"<br >"+s.desc,satHoverBoxNode2.textContent="",satHoverBoxNode3.textContent=""):sensorManager.checkSensorSelected()&&isShowNextPass&&T?(satHoverBoxNode1.textContent=s.ON,satHoverBoxNode2.textContent=s.SCC_NUM,satHoverBoxNode3.innerHTML=satellite.nextpass(s)+satellite.distance(s,r)+""):T?(satHoverBoxNode1.textContent=s.ON,satHoverBoxNode2.innerHTML=s.SCC_NUM+satellite.distance(s,r)+"",satHoverBoxNode3.innerHTML="X: "+s.position.x.toFixed(2)+" Y: "+s.position.y.toFixed(2)+" Z: "+s.position.z.toFixed(2)+"</br>X: "+s.velocityX.toFixed(2)+"km/s Y: "+s.velocityY.toFixed(2)+"km/s Z: "+s.velocityZ.toFixed(2)+"km/s"):sensorManager.checkSensorSelected()&&isShowNextPass?(satHoverBoxNode1.textContent=s.ON,satHoverBoxNode2.textContent=s.SCC_NUM,satHoverBoxNode3.textContent=satellite.nextpass(s)):(satHoverBoxNode1.textContent=s.ON,satHoverBoxNode2.textContent=s.SCC_NUM,satHoverBoxNode3.innerHTML="X: "+s.position.x.toFixed(2)+" Y: "+s.position.y.toFixed(2)+" Z: "+s.position.z.toFixed(2)+"</br>X: "+s.velocityX.toFixed(2)+" Y: "+s.velocityY.toFixed(2)+" Z: "+s.velocityZ.toFixed(2));satHoverBoxDOM.css({display:"block","text-align":"center",position:"absolute",left:t+20,top:a-10}),canvasDOM.css({cursor:"pointer"})}}var F=0,O=0}();var isSelectedSatNegativeOne=!1;function selectSat(e){var t;if(db.log("selectSat"),db.log(`satId: ${e}`,!0),-1!==e){if("Star"==(t=satSet.getSat(e)).type)return;if((0==t.active||void 0===t.active)&&void 0===t.staticNum)return}if(satSet.selectSat(e),camSnapMode=!1,-1===e&&(settingsManager.currentColorScheme===ColorScheme.group||$("#search").val().length>=3?$("#menu-sat-fov").removeClass("bmenu-item-disabled"):($("#menu-sat-fov").removeClass("bmenu-item-selected"),$("#menu-sat-fov").addClass("bmenu-item-disabled"),settingsManager.isSatOverflyModeOn=!1,satCruncher.postMessage({isShowSatOverfly:"reset"}))),-1!==e||isSelectedSatNegativeOne){if(isSelectedSatNegativeOne=!1,selectedSat=e,!(t=satSet.getSatExtraOnly(e)))return;if("Star"==t.type)return;if(t.static){if(void 0===t.staticNum)return;return adviceList.sensor(),t=satSet.getSat(e),sensorManager.setSensor(null,t.staticNum),sensorManager.curSensorPositon=[t.position.x,t.position.y,t.position.z],selectedSat=-1,$("#menu-sensor-info").removeClass("bmenu-item-disabled"),$("#menu-fov-bubble").removeClass("bmenu-item-disabled"),$("#menu-surveillance").removeClass("bmenu-item-disabled"),$("#menu-planetarium").removeClass("bmenu-item-disabled"),$("#menu-astronomy").removeClass("bmenu-item-disabled"),void(-1!==selectedSat&&$("#menu-lookangles").removeClass("bmenu-item-disabled"))}var a,s;camZoomSnappedOnSat=!0,camAngleSnappedOnSat=!0,orbitDisplay.setSelectOrbit(e),sensorManager.checkSensorSelected()&&$("#menu-lookangles").removeClass("bmenu-item-disabled"),$("#menu-lookanglesmultisite").removeClass("bmenu-item-disabled"),$("#menu-satview").removeClass("bmenu-item-disabled"),$("#menu-editSat").removeClass("bmenu-item-disabled"),$("#menu-sat-fov").removeClass("bmenu-item-disabled"),$("#menu-map").removeClass("bmenu-item-disabled"),$("#menu-newLaunch").removeClass("bmenu-item-disabled"),"block"===$("#search-results").css("display")?window.innerWidth<=1e3||($("#search-results").attr("style","display:block; max-height:27%"),cameraType.current,cameraType.PLANETARIUM):window.innerWidth<=1e3||($("#search-results").attr("style","max-height:27%"),cameraType.current,cameraType.PLANETARIUM),t.missile?$(".sat-only-info").hide():$(".sat-only-info").show(),$("#sat-infobox").fadeIn(),$("#sat-info-title").html(t.ON),t.URL&&""!==t.URL&&$("#sat-info-title").html("<a class='iframe' href='"+t.URL+"'>"+t.ON+"</a>"),$("#edit-satinfo-link").html("<a class='iframe' href='editor.htm?scc="+t.SCC_NUM+"&popup=true'>Edit Satellite Info</a>"),$("#sat-intl-des").html(t.intlDes),"unknown"===t.OT?$("#sat-objnum").html(1+t.TLE2.substr(2,7).toString()):($("#sat-objnum").html(t.SCC_NUM),ga("send","event","Satellite","SCC: "+t.SCC_NUM,"SCC Number")),0===t.OT&&(a="TBA"),1===t.OT&&(a="Payload"),2===t.OT&&(a="Rocket Body"),3===t.OT&&(a="Debris"),4===t.OT&&(a="Amateur Report"),t.missile&&(a="Ballistic Missile"),$("#sat-type").html(a),s=objectManager.extractCountry(t.C),$("#sat-country").html(s);var r,i,n,o=[];if(t.missile?(i=(o=t.desc.split("("))[0].substr(0,o[0].length-1),r=t.desc.split("(")[1].split(")")[0],o.site=i,o.sitec=t.C):o=objectManager.extractLaunchSite(t.LS),$("#sat-site").html(o.site),$("#sat-sitec").html(o.sitec),ga("send","event","Satellite","Country: "+s,"Country"),ga("send","event","Satellite","Site: "+o,"Site"),t.missile?(t.LV=r,$("#sat-vehicle").html(t.LV)):($("#sat-vehicle").html(t.LV),"U"===t.LV&&$("#sat-vehicle").html("Unknown"),objectManager.extractLiftVehicle(t.LV)),null===t.R||void 0===t.R)$("#sat-rcs").html("Unknown");else t.R<.1&&(n="Small"),t.R>=.1&&(n="Medium"),t.R>1&&(n="Large"),$("#sat-rcs").html(n),$("#sat-rcs").tooltip({delay:50,html:t.R,position:"left"});if(!t.missile){$("a.iframe").colorbox({iframe:!0,width:"80%",height:"80%",fastIframe:!1,closeButton:!1}),$("#sat-apogee").html(t.apogee.toFixed(0)+" km"),$("#sat-perigee").html(t.perigee.toFixed(0)+" km"),$("#sat-inclination").html((t.inclination*RAD2DEG).toFixed(2)+"Â°"),$("#sat-eccentricity").html(t.eccentricity.toFixed(3)),$("#sat-period").html(t.period.toFixed(2)+" min"),$("#sat-period").tooltip({delay:50,html:"Mean Motion: "+MINUTES_PER_DAY/t.period.toFixed(2),position:"left"}),void 0!==t.U&&""!=t.U?$("#sat-user").html(t.U):$("#sat-user").html("Unknown"),void 0!==t.P&&""!=t.P?$("#sat-purpose").html(t.P):$("#sat-purpose").html("Unknown"),void 0!==t.Con&&""!=t.Con?$("#sat-contractor").html(t.Con):$("#sat-contractor").html("Unknown"),void 0!==t.LM&&""!=t.LM?$("#sat-lmass").html(t.LM+" kg"):$("#sat-lmass").html("Unknown"),void 0!==t.DM&&""!=t.DM?$("#sat-dmass").html(t.DM+" kg"):$("#sat-dmass").html("Unknown"),void 0!==t.Li&&""!=t.Li?$("#sat-life").html(t.Li+" yrs"):$("#sat-life").html("Unknown"),void 0!==t.Pw&&""!=t.Pw?$("#sat-power").html(t.Pw+" w"):$("#sat-power").html("Unknown"),void 0!==t.vmag&&""!=t.vmag?$("#sat-vmag").html(t.vmag):$("#sat-vmag").html("Unknown"),void 0!==t.S1&&""!=t.S1?($("#sat-source1").html(`<a class="iframe" href="${t.S1}">${t.S1.split("//").splice(1)}</a>`),$("#sat-source1w").show()):($("#sat-source1").html("Unknown"),$("#sat-source1w").hide()),void 0!==t.S2&&""!=t.S2?($("#sat-source2").html(`<a class="iframe" href="${t.S2}">${t.S2.split("//").splice(1)}</a>`),$("#sat-source2w").show()):($("#sat-source2").html("Unknown"),$("#sat-source2w").hide()),void 0!==t.S3&&""!=t.S3?($("#sat-source3").html(`<a class="iframe" href="${t.S3}">${t.S3.split("//").splice(1)}</a>`),$("#sat-source3w").show()):($("#sat-source3").html("Unknown"),$("#sat-source3w").hide()),void 0!==t.S4&&""!=t.S4?($("#sat-source4").html(`<a class="iframe" href="${t.S4}">${t.S4.split("//").splice(1)}</a>`),$("#sat-source4w").show()):($("#sat-source4").html("Unknown"),$("#sat-source4w").hide()),void 0!==t.S5&&""!=t.S5?($("#sat-source5").html(`<a class="iframe" href="${t.S5}">${t.S5.split("//").splice(1)}</a>`),$("#sat-source5w").show()):($("#sat-source5").html("Unknown"),$("#sat-source5w").hide()),void 0!==t.S6&&""!=t.S6?($("#sat-source6").html(`<a class="iframe" href="${t.S6}">${t.S6.split("//").splice(1)}</a>`),$("#sat-source6w").show()):($("#sat-source6").html("Unknown"),$("#sat-source6w").hide()),void 0!==t.S7&&""!=t.S7?($("#sat-source7").html(`<a class="iframe" href="${t.S7}">${t.S7.split("//").splice(1)}</a>`),$("#sat-source7w").show()):($("#sat-source7").html("Unknown"),$("#sat-source7w").hide()),void 0!==t.URL&&""!=t.URL?($("#sat-sourceURL").html(`<a class="iframe" href="${t.URL}">${t.URL.split("//").splice(1)}</a>`),$("#sat-source8w").show()):($("#sat-source8").html("Unknown"),$("#sat-source8w").hide()),$("a.iframe").colorbox({iframe:!0,width:"80%",height:"80%",fastIframe:!1,closeButton:!1});var c,d=new Date,l=timeManager.getDayOfYear(d);d=(d=d.getFullYear()).toString().substr(2,2),c=satSet.getSat(e).TLE1.substr(18,2)===d?l-satSet.getSat(e).TLE1.substr(20,3):l-satSet.getSat(e).TLE1.substr(20,3)+365*satSet.getSat(e).TLE1.substr(17,2),$("#sat-elset-age").html(c+" Days"),$("#sat-elset-age").tooltip({delay:50,html:"Epoch Year: "+t.TLE1.substr(18,2).toString()+" Day: "+t.TLE1.substr(20,8).toString(),position:"left"}),d=new Date(timeManager.propRealTime+timeManager.propOffset);var m=SunCalc.getTimes(d,sensorManager.currentSensor.lat,sensorManager.currentSensor.long),p=t.isInSun;sensorManager.checkSensorSelected()?"Optical"!==sensorManager.currentSensor.type&&"Observer"!==sensorManager.currentSensor.type?$("#sat-sun").html("No Effect"):m.dawn.getTime()-d>0||m.dusk.getTime()-d<0?(0==p&&$("#sat-sun").html("No Sunlight"),1==p&&$("#sat-sun").html("Limited Sunlight"),2==p&&$("#sat-sun").html("Direct Sunlight")):"Invalid Date"==m.night||"Invalid Date"!=m.dawn&&"Invalid Date"!=m.dusk?$("#sat-sun").html("Sun Exclusion"):(0==p&&$("#sat-sun").html("No Sunlight"),1==p&&$("#sat-sun").html("Limited Sunlight"),2==p&&$("#sat-sun").html("Direct Sunlight")):(0==p&&$("#sat-sun").html("No Sunlight"),1==p&&$("#sat-sun").html("Limited Sunlight"),2==p&&$("#sat-sun").html("Direct Sunlight"))}sensorManager.checkSensorSelected()&&isLookanglesMenuOpen&&satellite.getlookangles(t)}else isSelectedSatNegativeOne=!0,$("#sat-infobox").fadeOut(),orbitDisplay.clearSelectOrbit(),$("#menu-lookanglesmultisite").removeClass("bmenu-item-selected"),$("#menu-lookangles").removeClass("bmenu-item-selected"),$("#menu-editSat").removeClass("bmenu-item-selected"),$("#menu-map").removeClass("bmenu-item-selected"),$("#menu-newLaunch").removeClass("bmenu-item-selected"),$("#menu-breakup").removeClass("bmenu-item-selected"),$("#menu-customSensor").removeClass("bmenu-item-selected"),$("#menu-lookanglesmultisite").addClass("bmenu-item-disabled"),$("#menu-lookangles").addClass("bmenu-item-disabled"),$("#menu-satview").addClass("bmenu-item-disabled"),$("#menu-editSat").addClass("bmenu-item-disabled"),$("#menu-map").addClass("bmenu-item-disabled"),$("#menu-newLaunch").addClass("bmenu-item-disabled"),$("#menu-breakup").addClass("bmenu-item-disabled"),$("#editSat-menu").effect("slide",{direction:"left",mode:"hide"},1e3),$("#map-menu").effect("slide",{direction:"left",mode:"hide"},1e3),$("#newLaunch-menu").effect("slide",{direction:"left",mode:"hide"},1e3),$("#breakup-menu").effect("slide",{direction:"left",mode:"hide"},1e3),$("#customSensor-menu").effect("slide",{direction:"left",mode:"hide"},1e3),isEditSatMenuOpen=!1,isLookanglesMenuOpen=!1,settingsManager.isMapMenuOpen=!1,isLookanglesMultiSiteMenuOpen=!1,isNewLaunchMenuOpen=!1,isBreakupMenuOpen=!1,isMissileMenuOpen=!1,isCustomSensorMenuOpen=!1;selectedSat=e,-1!==e&&(void 0!==t.TTP?($("#sat-ttp-wrapper").show(),$("#sat-ttp").html(t.TTP)):$("#sat-ttp-wrapper").hide(),void 0!==t.NOTES?($("#sat-notes-wrapper").show(),$("#sat-notes").html(t.NOTES)):$("#sat-notes-wrapper").hide(),void 0!==t.FMISSED?($("#sat-fmissed-wrapper").show(),$("#sat-fmissed").html(t.FMISSED)):$("#sat-fmissed-wrapper").hide(),void 0!==t.ORPO?($("#sat-oRPO-wrapper").show(),$("#sat-oRPO").html(t.ORPO)):$("#sat-oRPO-wrapper").hide(),void 0!==t.constellation?($("#sat-constellation-wrapper").show(),$("#sat-constellation").html(t.constellation)):$("#sat-constellation-wrapper").hide(),void 0!==t.maneuver?($("#sat-maneuver-wrapper").show(),$("#sat-maneuver").html(t.maneuver)):$("#sat-maneuver-wrapper").hide(),void 0!==t.associates?($("#sat-associates-wrapper").show(),$("#sat-associates").html(t.associates)):$("#sat-associates-wrapper").hide(),uiManager.updateMap()),updateUrl()}function enableSlowCPUMode(){db.log("enableSlowCPUMode"),settingsManager.cruncherReady&&(settingsManager.isSlowCPUModeEnabled=!0,settingsManager.minimumSearchCharacters=3,settingsManager.satLabelInterval=500,satCruncher.postMessage({isSlowCPUModeEnabled:!0}))}function debugDrawLine(e,t,a){switch(void 0===a&&(a=[1,0,1,1]),a){case"r":a=[1,0,0,1];break;case"o":a=[1,.5,0,1];break;case"y":a=[1,1,0,1];break;case"g":a=[0,1,0,1];break;case"b":a=[0,0,1,1];break;case"c":a=[0,1,1,1];break;case"p":a=[1,0,1,1]}if("sat"==e){let e=satSet.getSat(t);drawLineList.push({line:new Line,sat:e,ref:[0,0,0],ref2:[e.position.x,e.position.y,e.position.z],color:a})}if("sat2"==e){let e=satSet.getSat(t[0]);drawLineList.push({line:new Line,sat:e,ref:[t[1],t[2],t[3]],ref2:[e.position.x,e.position.y,e.position.z],color:a})}if("sat3"==e){let e=satSet.getSat(t[0]);var s=satSet.getSat(t[1]);drawLineList.push({line:new Line,sat:e,sat2:s,ref:[e.position.x,e.position.y,e.position.z],ref2:[s.position.x,s.position.y,s.position.z],color:a})}"ref"==e&&drawLineList.push({line:new Line,ref:[0,0,0],ref2:[t[0],t[1],t[2]],color:a}),"ref2"==e&&drawLineList.push({line:new Line,ref:[t[0],t[1],t[2]],ref2:[t[3],t[4],t[5]],color:a})}var tempStar1,tempStar2,satPos,drawLinesI=0;function drawLines(){if(0!=drawLineList.length)for(drawLinesI=0;drawLinesI<drawLineList.length;drawLinesI++)void 0!==drawLineList[drawLinesI].sat?(drawLineList[drawLinesI].sat=satSet.getSatPosOnly(drawLineList[drawLinesI].sat.id),void 0!==drawLineList[drawLinesI].sat2?void 0!==drawLineList[drawLinesI].sat2.name?(void 0===drawLineList[drawLinesI].sat2.id&&(drawLineList[drawLinesI].sat2.id=satSet.getIdFromSensorName(drawLineList[drawLinesI].sat2.name)),drawLineList[drawLinesI].sat2=satSet.getSatPosOnly(drawLineList[drawLinesI].sat2.id),drawLineList[drawLinesI].line.set([drawLineList[drawLinesI].sat.position.x,drawLineList[drawLinesI].sat.position.y,drawLineList[drawLinesI].sat.position.z],[drawLineList[drawLinesI].sat2.position.x,drawLineList[drawLinesI].sat2.position.y,drawLineList[drawLinesI].sat2.position.z])):(drawLineList[drawLinesI].sat2=satSet.getSatPosOnly(drawLineList[drawLinesI].sat2.id),drawLineList[drawLinesI].line.set([drawLineList[drawLinesI].sat.position.x,drawLineList[drawLinesI].sat.position.y,drawLineList[drawLinesI].sat.position.z],[drawLineList[drawLinesI].sat2.position.x,drawLineList[drawLinesI].sat2.position.y,drawLineList[drawLinesI].sat2.position.z])):drawLineList[drawLinesI].line.set(drawLineList[drawLinesI].ref,[drawLineList[drawLinesI].sat.position.x,drawLineList[drawLinesI].sat.position.y,drawLineList[drawLinesI].sat.position.z])):void 0!==drawLineList[drawLinesI].star1&&void 0!==drawLineList[drawLinesI].star2?(void 0===drawLineList[drawLinesI].star1ID&&(drawLineList[drawLinesI].star1ID=satSet.getIdFromStarName(drawLineList[drawLinesI].star1)),void 0===drawLineList[drawLinesI].star2ID&&(drawLineList[drawLinesI].star2ID=satSet.getIdFromStarName(drawLineList[drawLinesI].star2)),tempStar1=satSet.getSatPosOnly(drawLineList[drawLinesI].star1ID),tempStar2=satSet.getSatPosOnly(drawLineList[drawLinesI].star2ID),drawLineList[drawLinesI].line.set([tempStar1.position.x,tempStar1.position.y,tempStar1.position.z],[tempStar2.position.x,tempStar2.position.y,tempStar2.position.z])):drawLineList[drawLinesI].line.set(drawLineList[drawLinesI].ref,drawLineList[drawLinesI].ref2),drawLineList[drawLinesI].line.draw(drawLineList[drawLinesI].color)}